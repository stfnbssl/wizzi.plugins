const fs = require("fs");
const pptx = require("pptxgenjs");
const sharp = require("sharp");

const ppt_doc_1 = new pptx();
const ppt_doc_1_debug = { defaultStyle: {}, styles: {}, slides: [] };
async function generatePresentation(callback) {
    const defaultStyle = { content: {} };
    const styles = {};
    const ppt_styleDef_2 = {};
    ppt_styleDef_2.fontFace = "Montserrat";
    ppt_styleDef_2.fontSize = 6;
    ppt_styleDef_2.color = "000000";
    styles["Text_Montserrat_6"] = ppt_styleDef_2;
    ppt_doc_1_debug.styles["Text_Montserrat_6"] = ppt_styleDef_2;
    const ppt_styleDef_3 = {};
    ppt_styleDef_3.fontFace = "Montserrat";
    ppt_styleDef_3.fontSize = 8;
    ppt_styleDef_3.color = "000000";
    styles["Text_Montserrat_8"] = ppt_styleDef_3;
    ppt_doc_1_debug.styles["Text_Montserrat_8"] = ppt_styleDef_3;
    const ppt_styleDef_4 = {};
    ppt_styleDef_4.fontFace = "Montserrat";
    ppt_styleDef_4.fontSize = 10;
    ppt_styleDef_4.color = "000000";
    styles["Text_Montserrat_10"] = ppt_styleDef_4;
    ppt_doc_1_debug.styles["Text_Montserrat_10"] = ppt_styleDef_4;
    const ppt_styleDef_5 = {};
    ppt_styleDef_5.fontFace = "Montserrat";
    ppt_styleDef_5.fontSize = 14;
    ppt_styleDef_5.color = "000000";
    styles["Text_Montserrat_14"] = ppt_styleDef_5;
    ppt_doc_1_debug.styles["Text_Montserrat_14"] = ppt_styleDef_5;
    const ppt_styleDef_6 = {};
    ppt_styleDef_6.fontFace = "Montserrat";
    ppt_styleDef_6.fontSize = 20;
    ppt_styleDef_6.color = "000000";
    styles["Text_Montserrat_20"] = ppt_styleDef_6;
    ppt_doc_1_debug.styles["Text_Montserrat_20"] = ppt_styleDef_6;
    const ppt_styleDef_7 = {};
    ppt_styleDef_7.fontFace = "Montserrat";
    ppt_styleDef_7.fontSize = 28;
    ppt_styleDef_7.color = "000000";
    styles["Text_Montserrat_28"] = ppt_styleDef_7;
    ppt_doc_1_debug.styles["Text_Montserrat_28"] = ppt_styleDef_7;
    const ppt_styleDef_8 = {};
    ppt_styleDef_8.fontFace = "Montserrat";
    ppt_styleDef_8.fontSize = 34;
    ppt_styleDef_8.color = "000000";
    styles["Text_Montserrat_34"] = ppt_styleDef_8;
    ppt_doc_1_debug.styles["Text_Montserrat_34"] = ppt_styleDef_8;
    const ppt_styleDef_9 = {};
    ppt_styleDef_9.fontFace = "Roboto";
    ppt_styleDef_9.fontSize = 6;
    ppt_styleDef_9.color = "000000";
    styles["Text_Roboto_6"] = ppt_styleDef_9;
    ppt_doc_1_debug.styles["Text_Roboto_6"] = ppt_styleDef_9;
    const ppt_styleDef_10 = {};
    ppt_styleDef_10.fontFace = "Roboto";
    ppt_styleDef_10.fontSize = 8;
    ppt_styleDef_10.color = "000000";
    styles["Text_Roboto_8"] = ppt_styleDef_10;
    ppt_doc_1_debug.styles["Text_Roboto_8"] = ppt_styleDef_10;
    const ppt_styleDef_11 = {};
    ppt_styleDef_11.fontFace = "Roboto";
    ppt_styleDef_11.fontSize = 10;
    ppt_styleDef_11.color = "000000";
    styles["Text_Roboto_10"] = ppt_styleDef_11;
    ppt_doc_1_debug.styles["Text_Roboto_10"] = ppt_styleDef_11;
    const ppt_styleDef_12 = {};
    ppt_styleDef_12.fontFace = "Roboto";
    ppt_styleDef_12.fontSize = 14;
    ppt_styleDef_12.color = "000000";
    styles["Text_Roboto_14"] = ppt_styleDef_12;
    ppt_doc_1_debug.styles["Text_Roboto_14"] = ppt_styleDef_12;
    const ppt_styleDef_13 = {};
    ppt_styleDef_13.fontFace = "Roboto";
    ppt_styleDef_13.fontSize = 20;
    ppt_styleDef_13.color = "000000";
    styles["Text_Roboto_20"] = ppt_styleDef_13;
    ppt_doc_1_debug.styles["Text_Roboto_20"] = ppt_styleDef_13;
    const ppt_styleDef_14 = {};
    ppt_styleDef_14.fontFace = "Roboto";
    ppt_styleDef_14.fontSize = 28;
    ppt_styleDef_14.color = "000000";
    styles["Text_Roboto_28"] = ppt_styleDef_14;
    ppt_doc_1_debug.styles["Text_Roboto_28"] = ppt_styleDef_14;
    const ppt_styleDef_15 = {};
    ppt_styleDef_15.fontFace = "Roboto";
    ppt_styleDef_15.fontSize = 34;
    ppt_styleDef_15.color = "000000";
    styles["Text_Roboto_34"] = ppt_styleDef_15;
    ppt_doc_1_debug.styles["Text_Roboto_34"] = ppt_styleDef_15;
    const ppt_styleDef_16 = {};
    ppt_styleDef_16.fontFace = "Source Sans Pro";
    ppt_styleDef_16.fontSize = 6;
    ppt_styleDef_16.color = "000000";
    styles["Text_Source Sans Pro_6"] = ppt_styleDef_16;
    ppt_doc_1_debug.styles["Text_Source Sans Pro_6"] = ppt_styleDef_16;
    const ppt_styleDef_17 = {};
    ppt_styleDef_17.fontFace = "Source Sans Pro";
    ppt_styleDef_17.fontSize = 8;
    ppt_styleDef_17.color = "000000";
    styles["Text_Source Sans Pro_8"] = ppt_styleDef_17;
    ppt_doc_1_debug.styles["Text_Source Sans Pro_8"] = ppt_styleDef_17;
    const ppt_styleDef_18 = {};
    ppt_styleDef_18.fontFace = "Source Sans Pro";
    ppt_styleDef_18.fontSize = 10;
    ppt_styleDef_18.color = "000000";
    styles["Text_Source Sans Pro_10"] = ppt_styleDef_18;
    ppt_doc_1_debug.styles["Text_Source Sans Pro_10"] = ppt_styleDef_18;
    const ppt_styleDef_19 = {};
    ppt_styleDef_19.fontFace = "Source Sans Pro";
    ppt_styleDef_19.fontSize = 14;
    ppt_styleDef_19.color = "000000";
    styles["Text_Source Sans Pro_14"] = ppt_styleDef_19;
    ppt_doc_1_debug.styles["Text_Source Sans Pro_14"] = ppt_styleDef_19;
    const ppt_styleDef_20 = {};
    ppt_styleDef_20.fontFace = "Source Sans Pro";
    ppt_styleDef_20.fontSize = 20;
    ppt_styleDef_20.color = "000000";
    styles["Text_Source Sans Pro_20"] = ppt_styleDef_20;
    ppt_doc_1_debug.styles["Text_Source Sans Pro_20"] = ppt_styleDef_20;
    const ppt_styleDef_21 = {};
    ppt_styleDef_21.fontFace = "Source Sans Pro";
    ppt_styleDef_21.fontSize = 28;
    ppt_styleDef_21.color = "000000";
    styles["Text_Source Sans Pro_28"] = ppt_styleDef_21;
    ppt_doc_1_debug.styles["Text_Source Sans Pro_28"] = ppt_styleDef_21;
    const ppt_styleDef_22 = {};
    ppt_styleDef_22.fontFace = "Source Sans Pro";
    ppt_styleDef_22.fontSize = 34;
    ppt_styleDef_22.color = "000000";
    styles["Text_Source Sans Pro_34"] = ppt_styleDef_22;
    ppt_doc_1_debug.styles["Text_Source Sans Pro_34"] = ppt_styleDef_22;
    const ppt_slide_23 = ppt_doc_1.addSlide();
    const ppt_slide_23_debug = { items: [] };
    var ppt_p_24 = Object.assign({}, defaultStyle.content);
    const ppt_p_24_text = "Proxit sed albis in iura Montserrat 6";
    ppt_p_24 = Object.assign({},ppt_p_24, (styles["Text_Montserrat_6"] || {}));
    ppt_p_24.y = "10%";
    ppt_p_24.x = "10%";
    ppt_p_24.align = "left";
    ppt_p_24.isTextBox = true;
    ppt_slide_23.addText(ppt_p_24_text, ppt_p_24);
    ppt_slide_23_debug.items.push({ text: ppt_p_24_text, options: ppt_p_24 });
    var ppt_p_25 = Object.assign({}, defaultStyle.content);
    const ppt_p_25_text = "Proxit sed albis in iura Montserrat 8";
    ppt_p_25 = Object.assign({},ppt_p_25, (styles["Text_Montserrat_8"] || {}));
    ppt_p_25.y = "13%";
    ppt_p_25.x = "10%";
    ppt_p_25.align = "left";
    ppt_p_25.isTextBox = true;
    ppt_slide_23.addText(ppt_p_25_text, ppt_p_25);
    ppt_slide_23_debug.items.push({ text: ppt_p_25_text, options: ppt_p_25 });
    var ppt_p_26 = Object.assign({}, defaultStyle.content);
    const ppt_p_26_text = "Proxit sed albis in iura Montserrat 10";
    ppt_p_26 = Object.assign({},ppt_p_26, (styles["Text_Montserrat_10"] || {}));
    ppt_p_26.y = "17%";
    ppt_p_26.x = "10%";
    ppt_p_26.align = "left";
    ppt_p_26.isTextBox = true;
    ppt_slide_23.addText(ppt_p_26_text, ppt_p_26);
    ppt_slide_23_debug.items.push({ text: ppt_p_26_text, options: ppt_p_26 });
    var ppt_p_27 = Object.assign({}, defaultStyle.content);
    const ppt_p_27_text = "Proxit sed albis in iura Montserrat 14";
    ppt_p_27 = Object.assign({},ppt_p_27, (styles["Text_Montserrat_14"] || {}));
    ppt_p_27.y = "22%";
    ppt_p_27.x = "10%";
    ppt_p_27.align = "left";
    ppt_p_27.isTextBox = true;
    ppt_slide_23.addText(ppt_p_27_text, ppt_p_27);
    ppt_slide_23_debug.items.push({ text: ppt_p_27_text, options: ppt_p_27 });
    var ppt_p_28 = Object.assign({}, defaultStyle.content);
    const ppt_p_28_text = "Proxit sed albis in iura Montserrat 20";
    ppt_p_28 = Object.assign({},ppt_p_28, (styles["Text_Montserrat_20"] || {}));
    ppt_p_28.y = "29%";
    ppt_p_28.x = "10%";
    ppt_p_28.align = "left";
    ppt_p_28.isTextBox = true;
    ppt_slide_23.addText(ppt_p_28_text, ppt_p_28);
    ppt_slide_23_debug.items.push({ text: ppt_p_28_text, options: ppt_p_28 });
    var ppt_p_29 = Object.assign({}, defaultStyle.content);
    const ppt_p_29_text = "Proxit sed albis in iura Montserrat 28";
    ppt_p_29 = Object.assign({},ppt_p_29, (styles["Text_Montserrat_28"] || {}));
    ppt_p_29.y = "39%";
    ppt_p_29.x = "10%";
    ppt_p_29.align = "left";
    ppt_p_29.isTextBox = true;
    ppt_slide_23.addText(ppt_p_29_text, ppt_p_29);
    ppt_slide_23_debug.items.push({ text: ppt_p_29_text, options: ppt_p_29 });
    var ppt_p_30 = Object.assign({}, defaultStyle.content);
    const ppt_p_30_text = "Proxit sed albis in iura Montserrat 34";
    ppt_p_30 = Object.assign({},ppt_p_30, (styles["Text_Montserrat_34"] || {}));
    ppt_p_30.y = "53%";
    ppt_p_30.x = "10%";
    ppt_p_30.align = "left";
    ppt_p_30.isTextBox = true;
    ppt_slide_23.addText(ppt_p_30_text, ppt_p_30);
    ppt_slide_23_debug.items.push({ text: ppt_p_30_text, options: ppt_p_30 });
    ppt_doc_1_debug.slides.push(ppt_slide_23_debug);
    const ppt_slide_31 = ppt_doc_1.addSlide();
    const ppt_slide_31_debug = { items: [] };
    var ppt_p_32 = Object.assign({}, defaultStyle.content);
    const ppt_p_32_text = "Proxit sed albis in iura Roboto 6";
    ppt_p_32 = Object.assign({},ppt_p_32, (styles["Text_Roboto_6"] || {}));
    ppt_p_32.y = "10%";
    ppt_p_32.x = "10%";
    ppt_p_32.align = "left";
    ppt_p_32.isTextBox = true;
    ppt_slide_31.addText(ppt_p_32_text, ppt_p_32);
    ppt_slide_31_debug.items.push({ text: ppt_p_32_text, options: ppt_p_32 });
    var ppt_p_33 = Object.assign({}, defaultStyle.content);
    const ppt_p_33_text = "Proxit sed albis in iura Roboto 8";
    ppt_p_33 = Object.assign({},ppt_p_33, (styles["Text_Roboto_8"] || {}));
    ppt_p_33.y = "13%";
    ppt_p_33.x = "10%";
    ppt_p_33.align = "left";
    ppt_p_33.isTextBox = true;
    ppt_slide_31.addText(ppt_p_33_text, ppt_p_33);
    ppt_slide_31_debug.items.push({ text: ppt_p_33_text, options: ppt_p_33 });
    var ppt_p_34 = Object.assign({}, defaultStyle.content);
    const ppt_p_34_text = "Proxit sed albis in iura Roboto 10";
    ppt_p_34 = Object.assign({},ppt_p_34, (styles["Text_Roboto_10"] || {}));
    ppt_p_34.y = "17%";
    ppt_p_34.x = "10%";
    ppt_p_34.align = "left";
    ppt_p_34.isTextBox = true;
    ppt_slide_31.addText(ppt_p_34_text, ppt_p_34);
    ppt_slide_31_debug.items.push({ text: ppt_p_34_text, options: ppt_p_34 });
    var ppt_p_35 = Object.assign({}, defaultStyle.content);
    const ppt_p_35_text = "Proxit sed albis in iura Roboto 14";
    ppt_p_35 = Object.assign({},ppt_p_35, (styles["Text_Roboto_14"] || {}));
    ppt_p_35.y = "22%";
    ppt_p_35.x = "10%";
    ppt_p_35.align = "left";
    ppt_p_35.isTextBox = true;
    ppt_slide_31.addText(ppt_p_35_text, ppt_p_35);
    ppt_slide_31_debug.items.push({ text: ppt_p_35_text, options: ppt_p_35 });
    var ppt_p_36 = Object.assign({}, defaultStyle.content);
    const ppt_p_36_text = "Proxit sed albis in iura Roboto 20";
    ppt_p_36 = Object.assign({},ppt_p_36, (styles["Text_Roboto_20"] || {}));
    ppt_p_36.y = "29%";
    ppt_p_36.x = "10%";
    ppt_p_36.align = "left";
    ppt_p_36.isTextBox = true;
    ppt_slide_31.addText(ppt_p_36_text, ppt_p_36);
    ppt_slide_31_debug.items.push({ text: ppt_p_36_text, options: ppt_p_36 });
    var ppt_p_37 = Object.assign({}, defaultStyle.content);
    const ppt_p_37_text = "Proxit sed albis in iura Roboto 28";
    ppt_p_37 = Object.assign({},ppt_p_37, (styles["Text_Roboto_28"] || {}));
    ppt_p_37.y = "39%";
    ppt_p_37.x = "10%";
    ppt_p_37.align = "left";
    ppt_p_37.isTextBox = true;
    ppt_slide_31.addText(ppt_p_37_text, ppt_p_37);
    ppt_slide_31_debug.items.push({ text: ppt_p_37_text, options: ppt_p_37 });
    var ppt_p_38 = Object.assign({}, defaultStyle.content);
    const ppt_p_38_text = "Proxit sed albis in iura Roboto 34";
    ppt_p_38 = Object.assign({},ppt_p_38, (styles["Text_Roboto_34"] || {}));
    ppt_p_38.y = "53%";
    ppt_p_38.x = "10%";
    ppt_p_38.align = "left";
    ppt_p_38.isTextBox = true;
    ppt_slide_31.addText(ppt_p_38_text, ppt_p_38);
    ppt_slide_31_debug.items.push({ text: ppt_p_38_text, options: ppt_p_38 });
    ppt_doc_1_debug.slides.push(ppt_slide_31_debug);
    const ppt_slide_39 = ppt_doc_1.addSlide();
    const ppt_slide_39_debug = { items: [] };
    var ppt_p_40 = Object.assign({}, defaultStyle.content);
    const ppt_p_40_text = "Proxit sed albis in iura Source Sans Pro 6";
    ppt_p_40 = Object.assign({},ppt_p_40, (styles["Text_Source Sans Pro_6"] || {}));
    ppt_p_40.y = "10%";
    ppt_p_40.x = "10%";
    ppt_p_40.align = "left";
    ppt_p_40.isTextBox = true;
    ppt_slide_39.addText(ppt_p_40_text, ppt_p_40);
    ppt_slide_39_debug.items.push({ text: ppt_p_40_text, options: ppt_p_40 });
    var ppt_p_41 = Object.assign({}, defaultStyle.content);
    const ppt_p_41_text = "Proxit sed albis in iura Source Sans Pro 8";
    ppt_p_41 = Object.assign({},ppt_p_41, (styles["Text_Source Sans Pro_8"] || {}));
    ppt_p_41.y = "13%";
    ppt_p_41.x = "10%";
    ppt_p_41.align = "left";
    ppt_p_41.isTextBox = true;
    ppt_slide_39.addText(ppt_p_41_text, ppt_p_41);
    ppt_slide_39_debug.items.push({ text: ppt_p_41_text, options: ppt_p_41 });
    var ppt_p_42 = Object.assign({}, defaultStyle.content);
    const ppt_p_42_text = "Proxit sed albis in iura Source Sans Pro 10";
    ppt_p_42 = Object.assign({},ppt_p_42, (styles["Text_Source Sans Pro_10"] || {}));
    ppt_p_42.y = "17%";
    ppt_p_42.x = "10%";
    ppt_p_42.align = "left";
    ppt_p_42.isTextBox = true;
    ppt_slide_39.addText(ppt_p_42_text, ppt_p_42);
    ppt_slide_39_debug.items.push({ text: ppt_p_42_text, options: ppt_p_42 });
    var ppt_p_43 = Object.assign({}, defaultStyle.content);
    const ppt_p_43_text = "Proxit sed albis in iura Source Sans Pro 14";
    ppt_p_43 = Object.assign({},ppt_p_43, (styles["Text_Source Sans Pro_14"] || {}));
    ppt_p_43.y = "22%";
    ppt_p_43.x = "10%";
    ppt_p_43.align = "left";
    ppt_p_43.isTextBox = true;
    ppt_slide_39.addText(ppt_p_43_text, ppt_p_43);
    ppt_slide_39_debug.items.push({ text: ppt_p_43_text, options: ppt_p_43 });
    var ppt_p_44 = Object.assign({}, defaultStyle.content);
    const ppt_p_44_text = "Proxit sed albis in iura Source Sans Pro 20";
    ppt_p_44 = Object.assign({},ppt_p_44, (styles["Text_Source Sans Pro_20"] || {}));
    ppt_p_44.y = "29%";
    ppt_p_44.x = "10%";
    ppt_p_44.align = "left";
    ppt_p_44.isTextBox = true;
    ppt_slide_39.addText(ppt_p_44_text, ppt_p_44);
    ppt_slide_39_debug.items.push({ text: ppt_p_44_text, options: ppt_p_44 });
    var ppt_p_45 = Object.assign({}, defaultStyle.content);
    const ppt_p_45_text = "Proxit sed albis in iura Source Sans Pro 28";
    ppt_p_45 = Object.assign({},ppt_p_45, (styles["Text_Source Sans Pro_28"] || {}));
    ppt_p_45.y = "39%";
    ppt_p_45.x = "10%";
    ppt_p_45.align = "left";
    ppt_p_45.isTextBox = true;
    ppt_slide_39.addText(ppt_p_45_text, ppt_p_45);
    ppt_slide_39_debug.items.push({ text: ppt_p_45_text, options: ppt_p_45 });
    var ppt_p_46 = Object.assign({}, defaultStyle.content);
    const ppt_p_46_text = "Proxit sed albis in iura Source Sans Pro 34";
    ppt_p_46 = Object.assign({},ppt_p_46, (styles["Text_Source Sans Pro_34"] || {}));
    ppt_p_46.y = "53%";
    ppt_p_46.x = "10%";
    ppt_p_46.align = "left";
    ppt_p_46.isTextBox = true;
    ppt_slide_39.addText(ppt_p_46_text, ppt_p_46);
    ppt_slide_39_debug.items.push({ text: ppt_p_46_text, options: ppt_p_46 });
    ppt_doc_1_debug.slides.push(ppt_slide_39_debug);
    callback();
}
async function svgStringToBase64Png(svgString) {
    const buffer = await sharp(Buffer.from(svgString))
    .resize(800) // Optional resize
    .png()
    .toBuffer();
    return `data:image/png;base64,${buffer.toString("base64")}`;
}
generatePresentation(() => {
    
    // Dump for test
    fs.writeFileSync(__dirname + "/p02.ppt.json", JSON.stringify(ppt_doc_1_debug, null, "	"));
    
    // Make Ppt
    
    var now = new Date();
    
    ppt_doc_1.writeFile(
        __dirname + "/p02.ppt"
    ).then(fileName => {
        console.log(`created file: ${fileName}`);
        console.log("DONE written", new Date() - now)
    });
});
